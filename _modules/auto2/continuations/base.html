<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>auto2.continuations.base &mdash; auto-AUTO v0.5.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=1a12988a"></script>
        <script src="../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            auto-AUTO
          </a>
              <div class="version">
                v0.5.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../files/general_information.html">General Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../files/rationale.html">Rationale behind auto-AUTO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../files/user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../files/references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">auto-AUTO</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">auto2.continuations.base</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for auto2.continuations.base</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">Continuation base class definition</span>
<span class="sd">==================================</span>

<span class="sd">This module implements the definition used by any subsequent continuation subclass</span>
<span class="sd">in auto-AUTO.</span>


<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">contextmanager</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;general_logger&quot;</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">auto_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AUTO_DIR&quot;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">auto_directory</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># sys.path.append(auto_directory + &#39;/python/auto&#39;)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">auto_directory</span><span class="p">,</span> <span class="s2">&quot;python&quot;</span><span class="p">))</span>
<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unable to find auto directory environment variable.&quot;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">auto.AUTOCommands</span> <span class="k">as</span> <span class="nn">ac</span>
<span class="kn">from</span> <span class="nn">auto.AUTOExceptions</span> <span class="kn">import</span> <span class="n">AUTORuntimeError</span>


<span class="c1"># TODO: - Check what happens if parameters are integers</span>


<div class="viewcode-block" id="Continuation">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation">[docs]</a>
<span class="k">class</span> <span class="nc">Continuation</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for any continuation in auto-AUTO.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model_name: str</span>
<span class="sd">        The name of the model to load. Used to load the .f90 file of the provided model.</span>
<span class="sd">    config_object: ~auto2.parsers.config.ConfigParser</span>
<span class="sd">        A loaded ConfigParser object.</span>
<span class="sd">    path_name: str, optional</span>
<span class="sd">        The directory path where files are read/saved.</span>
<span class="sd">        If `None`, defaults to current working directory.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    model_name: str</span>
<span class="sd">        The name of the loaded model. Used to load the .f90 file of the provided model.</span>
<span class="sd">    config_object: ~auto2.parsers.config.ConfigParser</span>
<span class="sd">        A loaded ConfigParser object.</span>
<span class="sd">    continuation: dict</span>
<span class="sd">        Dictionary holding the forward and backward continuation data.</span>
<span class="sd">    branch_number: int</span>
<span class="sd">        The AUTO branch number attributed to the continuation(s). This number can be set manually by passing the IBR AUTO parameter when</span>
<span class="sd">        starting the continuations (see the :meth:`make_continuation` documentation for more details).</span>
<span class="sd">    initial_data: ~numpy.ndarray or AUTOSolution object</span>
<span class="sd">        The initial data used to start the continuation(s).</span>
<span class="sd">    auto_filename_suffix: str</span>
<span class="sd">        Suffix for the |AUTO| files used to save the continuation(s) data and parameters on disk.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">config_object</span><span class="p">,</span> <span class="n">path_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_object</span> <span class="o">=</span> <span class="n">config_object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_name</span> <span class="o">=</span> <span class="n">model_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branch_number</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auto_filename_suffix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_path_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">path_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_path_name</span><span class="p">(</span><span class="n">path_name</span><span class="p">)</span>

        <span class="c1"># plots default behaviours</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_marker</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_markersize</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_linestyle</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_linewidth</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># options</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_retry</span> <span class="o">=</span> <span class="mi">3</span>

<div class="viewcode-block" id="Continuation.make_continuation">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.make_continuation">[docs]</a>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">make_continuation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">initial_data</span><span class="p">,</span> <span class="n">auto_suffix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">only_forward</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">continuation_kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Make both forward and backward (if possible) continuation.</span>
<span class="sd">        To be implemented in subclasses.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        initial_data: ~numpy.ndarray or AUTOSolution</span>
<span class="sd">            Initial data used to start the continuation(s).</span>
<span class="sd">        auto_suffix: str, optional</span>
<span class="sd">            Suffix to use for the |AUTO| and Pickle files used to save the continuation(s)</span>
<span class="sd">            data, parameters and metadata on disk. If not provided, does not save the data on disk.</span>
<span class="sd">        only_forward: bool, optional</span>
<span class="sd">            If `True`, compute only the forward continuation (positive `DS` parameter).</span>
<span class="sd">            If `False`, compute in both backward and forward direction.</span>
<span class="sd">            Default to `False`.</span>
<span class="sd">        continuation_kwargs: dict</span>
<span class="sd">            Keyword arguments to be passed to the |AUTO| continuation.</span>
<span class="sd">            See below for further details.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        **AUTO Continuation Keyword Arguments**: See Section 10.8 in the |AUTO| documentation for further details.</span>
<span class="sd">        We provide below the most important ones:</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>

<span class="sd">        DS: float, optional</span>
<span class="sd">            AUTO uses pseudo-arclength continuation for following solution families.</span>
<span class="sd">            The pseudo-arclength stepsize is the distance between the current solution and the next solution on a family.</span>
<span class="sd">            By default, this distance includes all state variables (or state functions) and all free parameters.</span>
<span class="sd">            The constant `DS` defines the pseudo-arclength stepsize to be used for the first attempted step along any family.</span>
<span class="sd">            DS may be chosen positive or negative; changing its sign reverses the direction of computation.</span>
<span class="sd">            The relation `DSMIN` ≤ | `DS` | ≤ `DSMAX` must be satisfied. The precise choice of `DS` is problem-dependent.</span>
<span class="sd">        DSMIN: float, optional</span>
<span class="sd">            This is minimum allowable absolute value of the pseudo-arclength stepsize.</span>
<span class="sd">            `DSMIN` must be positive. It is only effective if the pseudo-arclength step is adaptive, i.e., if `IADS`&gt;0.</span>
<span class="sd">            The choice of `DSMIN` is highly problem-dependent.</span>
<span class="sd">        DSMAX: float, optional</span>
<span class="sd">            The maximum allowable absolute value of the pseudo-arclength stepsize.</span>
<span class="sd">            `DSMAX` must be positive.</span>
<span class="sd">            It is only effective if the pseudo-arclength step is adaptive, i.e., if `IADS`&gt;0.</span>
<span class="sd">            The choice of `DSMAX` is highly problem-dependent.</span>
<span class="sd">        NMX: int, optional</span>
<span class="sd">            The maximum number of steps to be taken along the branch.</span>
<span class="sd">        IBR: int, optional</span>
<span class="sd">            This constant specifies the initial branch number BR that is used. The default `IBR=0` means that</span>
<span class="sd">            that this number is determined automatically.</span>
<span class="sd">        ILP: int, optional</span>
<span class="sd">            * If `ILP=0`: No detection of folds. This is the recommended choice in the AUTO documentation.</span>

<span class="sd">            * If `ILP=1`: Detection of folds. To be used if subsequent fold continuation is intended.</span>
<span class="sd">        SP: list(str), optional</span>
<span class="sd">            This constant controls the detection of bifurcations and adds stopping conditions.</span>
<span class="sd">            It is specified as a list of bifurcation type strings followed by an optional number.</span>
<span class="sd">            If this number is `0`, then the detection of this bifurcation is turned off, and if it is missing then the detection is turned on.</span>
<span class="sd">            A number `n` greater than zero specifies that the continuation should stop as soon as the nth bifurcation of this type has been</span>
<span class="sd">            reached.</span>
<span class="sd">            Examples:</span>

<span class="sd">            - `SP=[’LP0’]` turn off detection of folds.</span>

<span class="sd">            - `SP=[’LP’,’HB3’,’BP0’,’UZ3’]` turn on the detection of folds and Hopf bifurcations, turn off detection of branch points</span>
<span class="sd">              and stop at the third Hopf bifurcation or third user defined point, whichever comes first.</span>
<span class="sd">        ISP: int, optional</span>
<span class="sd">            This constant controls the detection of Hopf bifurcations, branch points, period-doubling bifurcations, and torus bifurcations:</span>

<span class="sd">            * If `ISP=0` This setting disables the detection of Hopf bifurcations, branch points, period doubling bifurcations,</span>
<span class="sd">              and torus bifurcations and the computation of Floquet multipliers.</span>

<span class="sd">            * If `ISP=1` Branch points and Hopf bifurcations are detected for algebraic equations. Branch points, period-doubling</span>
<span class="sd">              bifurcations and torus bifurcations are not detected for periodic solutions and boundary value problems.</span>
<span class="sd">              However, Floquet multipliers are computed.</span>

<span class="sd">            * If `ISP=2` This setting enables the detection of all special solutions.</span>
<span class="sd">              For periodic solutions and rotations, the choice `ISP=2` should be used with care,</span>
<span class="sd">              due to potential inaccuracy in the computation of the linearized Poincar ́e map and possible rapid variation of the</span>
<span class="sd">              Floquet multipliers.</span>

<span class="sd">            * If `ISP=3` Hopf bifurcations will not be detected. Branch points will be detected, and AUTO will monitor</span>
<span class="sd">              the Floquet multipliers. Period-doubling and torus bifurcations will go undetected. This option is useful for</span>
<span class="sd">              certain problems with non-generic Floquet behavior.</span>

<span class="sd">            * If `ISP=4` Branch points and Hopf bifurcations are detected for algebraic equations. Branch points are not detected</span>
<span class="sd">              for periodic solutions and boundary value problems.</span>
<span class="sd">              AUTO will monitor the Floquet multipliers, and period-doubling and torus bifurcations will be detected.</span>
<span class="sd">        ISW: int, optional</span>
<span class="sd">            This constant controls branch switching at branch points for the case of differential equations. Note that branch switching</span>
<span class="sd">            is automatic for algebraic equations.</span>

<span class="sd">            * If `ISW=1` This is the normal value of `ISW`.</span>

<span class="sd">            * If `ISW=-1` If `IRS` is the label of a branch point or a period-doubling bifurcation then branch switching will be done.</span>
<span class="sd">              For period doubling bifurcations it is recommended that `NTST` be increased.</span>

<span class="sd">            * If `ISW=2` If IRS is the label of a fold, a Hopf bifurcation point, a period-doubling, a torus bifurcation,</span>
<span class="sd">              or, in a non-generic (symmetric) system, a branch point then a locus of such points will be computed.</span>

<span class="sd">            * If `ISW=3` If `IRS` is the label of a branch point in a generic (non-symmetric) system then a locus of such points will</span>
<span class="sd">              be computed. Two additional free parameters must be specified for such continuations</span>
<span class="sd">        MXBF: int, optional</span>
<span class="sd">            This constant, which is effective for algebraic problems only, sets the maximum number of bifurcations to be treated.</span>
<span class="sd">            Additional branch points will be noted, but the corresponding bifurcating families will not be computed.</span>
<span class="sd">        dat: str, optional</span>
<span class="sd">            This constant, where `dat=’filename’`, sets the name of a user-supplied ASCII data file `filename.dat`,</span>
<span class="sd">            from which the continuation is to be restarted.</span>
<span class="sd">            The first column in the data file denotes the time, which does not need to be rescaled to the</span>
<span class="sd">            interval `[0, 1]`, and further columns the coordinates of the solution. The parameter `IRS` must be</span>
<span class="sd">            set to `0`.</span>
<span class="sd">        PAR: dict, optional</span>
<span class="sd">             Determines the parameter values for the continuation to start from.</span>
<span class="sd">             Should be entred as `{&#39;parameter_name&#39;: parameter_value}`.</span>
<span class="sd">        IRS: int or str, optional</span>
<span class="sd">            This constant sets the label of the solution where the computation is to be restarted.</span>
<span class="sd">            Setting `IRS=0` is typically used in the first run of a new problem.</span>
<span class="sd">            To restart the computation at the `n`-th label, use `IRS=n`.</span>
<span class="sd">            To restart the computation at a specific label (for example `HB12`), use `IRS=HB12`.</span>
<span class="sd">        TY: str, optional</span>
<span class="sd">            This constant modifies the type from the restart solution.</span>
<span class="sd">            This is sometimes useful in conservative or extended systems, declaring a regular point to be</span>
<span class="sd">            a Hopf bifurcation point `TY=’HB’` or a branch point `TY=’BP’`.</span>
<span class="sd">        IPS: int, optional</span>
<span class="sd">            This constant defines the problem type:</span>

<span class="sd">            * If `IPS=0` algebraic bifurcation problem.</span>
<span class="sd">            * If `IPS=1` stationary solutions of ODEs with detection of Hopf bifurcations.</span>
<span class="sd">            * If `IPS=-1` fixed points of the discrete dynamical systems.</span>
<span class="sd">            * If `IPS=-2` time integration using implicit Euler.</span>
<span class="sd">            * If `IPS=2`  computation of periodic solutions.</span>
<span class="sd">            * If `IPS=4`  boundary value problems.</span>
<span class="sd">            * If `IPS=5`  algebraic optimization problems.</span>
<span class="sd">            * If `IPS=7`  boundary value problem with computation of Floquet multipliers.</span>
<span class="sd">            * If `IPS=9`  option is used in connection with the HomCont algorithms</span>
<span class="sd">            * If `IPS=11` spatially uniform solutions of a system of parabolic PDEs, with detection of traveling wave bifurcations.</span>
<span class="sd">            * If `IPS=12` continuation of traveling wave solutions to a system of parabolic PDEs.</span>
<span class="sd">            * If `IPS=14` time evolution for a system of parabolic PDEs subject to periodic boundary conditions.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="Continuation.make_forward_continuation">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.make_forward_continuation">[docs]</a>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">make_forward_continuation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">initial_data</span><span class="p">,</span> <span class="n">auto_suffix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">continuation_kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Make the forward continuation.</span>
<span class="sd">        To be implemented in subclasses.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        initial_data: ~numpy.ndarray or AUTOSolution</span>
<span class="sd">            Initial data used to start the continuation(s).</span>
<span class="sd">        auto_suffix: str, optional</span>
<span class="sd">            Suffix to use for the |AUTO| and Pickle files used to save the continuation(s)</span>
<span class="sd">            data, parameters and metadata on disk. If not provided, does not save the data on disk.</span>
<span class="sd">        continuation_kwargs: dict</span>
<span class="sd">            Keyword arguments to be passed to the |AUTO| continuation.</span>
<span class="sd">            See below for further details</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        **AUTO Continuation Keyword Arguments**: See Section 10.8 in the |AUTO| documentation for further details.</span>
<span class="sd">        The most important ones are provided in the documentation of the :meth:`make_continuation` method.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="Continuation.make_backward_continuation">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.make_backward_continuation">[docs]</a>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">make_backward_continuation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">initial_data</span><span class="p">,</span> <span class="n">auto_suffix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">continuation_kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Make the backward continuation.</span>
<span class="sd">        To be implemented in subclasses.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        initial_data: ~numpy.ndarray or AUTOSolution</span>
<span class="sd">            Initial data used to start the continuation(s).</span>
<span class="sd">        auto_suffix: str, optional</span>
<span class="sd">            Suffix to use for the |AUTO| and Pickle files used to save the continuation(s)</span>
<span class="sd">            data, parameters and metadata on disk. If not provided, does not save the data on disk.</span>
<span class="sd">        continuation_kwargs: dict</span>
<span class="sd">            Keyword arguments to be passed to the |AUTO| continuation.</span>
<span class="sd">            See below for further details</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        **AUTO Continuation Keyword Arguments**: See Section 10.8 in the |AUTO| documentation for further details.</span>
<span class="sd">        The most important ones are provided in the documentation of the :meth:`make_continuation` method.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>


    <span class="k">def</span> <span class="nf">_get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">state</span><span class="p">[</span><span class="s2">&quot;continuation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;forward&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;backward&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_data</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">str</span><span class="p">))</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="n">state</span><span class="p">[</span><span class="s2">&quot;initial_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">key</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;BR&quot;</span><span class="p">,</span> <span class="s2">&quot;PT&quot;</span><span class="p">,</span> <span class="s2">&quot;TY name&quot;</span><span class="p">,</span> <span class="s2">&quot;TY number&quot;</span><span class="p">,</span> <span class="s2">&quot;Label&quot;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="k">return</span> <span class="n">state</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_set_from_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">load_initial_data</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">path_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;str: The path where the |AUTO| and AUTO² files must be or are stored.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_name</span>

<div class="viewcode-block" id="Continuation.set_path_name">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.set_path_name">[docs]</a>
    <span class="k">def</span> <span class="nf">set_path_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the path where the |AUTO| and AUTO² files must be or are stored.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path_name: str</span>
<span class="sd">            The path.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path_name</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_path_name</span> <span class="o">=</span> <span class="n">path_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Path name given does not exist. Using the current working directory.&quot;</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_path_name</span> <span class="o">=</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Continuation.temporary_chdir">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.temporary_chdir">[docs]</a>
    <span class="nd">@contextmanager</span>
    <span class="k">def</span> <span class="nf">temporary_chdir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_dir</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        As AUTOCommands does not provide functionality to pass a filepath, this is a workaround to switch paths for loading/saving.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Store the current directory</span>
        <span class="n">original_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">new_dir</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">yield</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="c1"># Restore the original directory</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">original_dir</span><span class="p">)</span></div>


<div class="viewcode-block" id="Continuation.auto_save">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.auto_save">[docs]</a>
    <span class="k">def</span> <span class="nf">auto_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auto_suffix</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save the |AUTO| files for both the forward and backward continuations if they exist.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        auto_suffix: str</span>
<span class="sd">            Suffix to use for the |AUTO| files used to save the continuation data on disk.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="s2">&quot;backward&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">temporary_chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_path_name</span><span class="p">):</span>
                        <span class="n">ac</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">],</span> <span class="n">auto_suffix</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">direction</span>
                        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auto_filename_suffix</span> <span class="o">=</span> <span class="n">auto_suffix</span></div>


<div class="viewcode-block" id="Continuation.auto_load">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.auto_load">[docs]</a>
    <span class="k">def</span> <span class="nf">auto_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auto_suffix</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load the |AUTO| files for both the forward and backward continuations if they exist.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        auto_suffix: str</span>
<span class="sd">            Suffix to use for the |AUTO| files used to load the continuation data from disk.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="s2">&quot;backward&quot;</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Changing the directory</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">temporary_chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_path_name</span><span class="p">):</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="n">ac</span><span class="o">.</span><span class="n">loadbd</span><span class="p">(</span><span class="n">auto_suffix</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">direction</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">FileNotFoundError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">,</span> <span class="n">AUTORuntimeError</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Files not found. Unable to load data.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auto_filename_suffix</span> <span class="o">=</span> <span class="n">auto_suffix</span></div>


<div class="viewcode-block" id="Continuation.save">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.save">[docs]</a>
    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">auto_filename_suffix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save the |AUTO| files and the branch parameters and metadata for both</span>
<span class="sd">        the forward and backward continuations if they exist.</span>
<span class="sd">        The branch parameters and metadata will be stored in a Pickle file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename: str or None, optional</span>
<span class="sd">            The filename used to store the continuation(s) parameters and metadata</span>
<span class="sd">            to disk in Pickle format.</span>
<span class="sd">            If `None`, will assign a default generic name.</span>
<span class="sd">            Default is `None`.</span>
<span class="sd">        auto_filename_suffix: str or None, optional</span>
<span class="sd">            Suffix to use for the |AUTO| files used to save the continuation data from disk.</span>
<span class="sd">            If `None`, will assign a default generic suffix.</span>
<span class="sd">            Default is `None`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">auto_filename_suffix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isfixedpoint</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">auto_filename_suffix</span> <span class="o">=</span> <span class="s2">&quot;fp_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_number</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">auto_filename_suffix</span> <span class="o">=</span> <span class="s2">&quot;po_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_number</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;No AUTO filename suffix set. Using a default one: &quot;</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">auto_filename_suffix</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auto_filename_suffix</span> <span class="o">=</span> <span class="n">auto_filename_suffix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auto_save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">auto_filename_suffix</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isfixedpoint</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;fp_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_number</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.pickle&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;po_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_number</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.pickle&quot;</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;No pickle filename prefix provided. Using a default one: &quot;</span> <span class="o">+</span> <span class="n">filename</span>
            <span class="p">)</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dict</span><span class="p">()</span>

        <span class="n">filepath</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">filename</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_name</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_path_name</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Continuation.load">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.load">[docs]</a>
    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">load_initial_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load the |AUTO| files and the branch parameters and metadata for both</span>
<span class="sd">        the forward and backward continuations if they exist.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename: str</span>
<span class="sd">            The filename used to store the continuation(s) parameters and metadata</span>
<span class="sd">            to disk in Pickle format.</span>
<span class="sd">        load_initial_data: bool</span>
<span class="sd">            Try or not to load the initial data field.</span>
<span class="sd">            Default to `True`.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">filename</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_name</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="k">else</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_path_name</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">tmp_dict</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;File not found. Unable to load data.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_from_dict</span><span class="p">(</span><span class="n">tmp_dict</span><span class="p">,</span> <span class="n">load_initial_data</span><span class="o">=</span><span class="n">load_initial_data</span><span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">isfixedpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;bool: True if the current object is a fixed point continuation.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config_object</span><span class="o">.</span><span class="n">parameters_dict</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_variables</span>
            <span class="ow">and</span> <span class="mi">11</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_variables</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">isperiodicorbit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;bool: True if the current object is a periodic orbit continuation.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isfixedpoint</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">available_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;list(str): Return the available variables in the continuation data.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">phase_space_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;list(str): Return the variables of the phase space of the configured dynamical system.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_object</span><span class="o">.</span><span class="n">variables</span>

<div class="viewcode-block" id="Continuation.diagnostics">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.diagnostics">[docs]</a>
    <span class="k">def</span> <span class="nf">diagnostics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;str: Return the AUTO diagnostics of the continuations as a string.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;Forward</span><span class="se">\n</span><span class="s2">-----------------------</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">diagnostics</span><span class="p">:</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="n">t</span><span class="p">[</span><span class="s2">&quot;Text&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;Backward</span><span class="se">\n</span><span class="s2">-----------------------</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">diagnostics</span><span class="p">:</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="n">t</span><span class="p">[</span><span class="s2">&quot;Text&quot;</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">s</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Continuation.print_diagnostics">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.print_diagnostics">[docs]</a>
    <span class="k">def</span> <span class="nf">print_diagnostics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method which prints the full AUTO diagnostics of the continuations.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">diagnostics</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>


<div class="viewcode-block" id="Continuation.point_diagnostic">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.point_diagnostic">[docs]</a>
    <span class="k">def</span> <span class="nf">point_diagnostic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method which returns the diagnostic of a given point of the continuation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        idx: str or int</span>
<span class="sd">            |AUTO| index of the point to give the diagnostic from.</span>
<span class="sd">            If `idx`:</span>

<span class="sd">            * is a string, it should identify the label of the point, assuming the</span>
<span class="sd">              point has a label. Backward continuation label must be preceded by</span>
<span class="sd">              a `&#39;-&#39;` character. E.g. `&#39;HB2&#39;` would identify the second Hopf bifurcation</span>
<span class="sd">              point of the forward continuation, while `&#39;-UZ3&#39;` identifies the third</span>
<span class="sd">              user-defined label of the backward branch.</span>
<span class="sd">            * is an integer, it corresponds to the index of the point. Positive</span>
<span class="sd">              integers identify points on the forward continuation, while negative integers</span>
<span class="sd">              identify points on the backward continuation. The zero index identifies the</span>
<span class="sd">              initial point of the continuations.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            The point diagnostic.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_solution_by_label</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
                        <span class="n">idx</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="s2">&quot;PT&quot;</span><span class="p">]</span>
                        <span class="n">ix_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_index_map</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">return</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span>
                                <span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                                <span class="o">.</span><span class="n">diagnostics</span><span class="p">[</span><span class="n">ix_map</span><span class="p">[</span><span class="n">idx</span><span class="p">]][</span><span class="s2">&quot;Text&quot;</span><span class="p">]</span>
                            <span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No point diagnostic to show.&quot;</span><span class="p">)</span>
                            <span class="k">return</span> <span class="kc">None</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No backward branch to show the diagnostic for.&quot;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_solution_by_label</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
                        <span class="n">idx</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="s2">&quot;PT&quot;</span><span class="p">]</span>
                        <span class="n">ix_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_index_map</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;forward&quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">return</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span>
                                <span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                                <span class="o">.</span><span class="n">diagnostics</span><span class="p">[</span><span class="n">ix_map</span><span class="p">[</span><span class="n">idx</span><span class="p">]][</span><span class="s2">&quot;Text&quot;</span><span class="p">]</span>
                            <span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No point diagnostic to show.&quot;</span><span class="p">)</span>
                            <span class="k">return</span> <span class="kc">None</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No forward branch to show the diagnostic for.&quot;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ix_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_index_map</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;forward&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">ix_map</span><span class="p">:</span>
                        <span class="k">return</span> <span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span>
                            <span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="o">.</span><span class="n">diagnostics</span><span class="p">[</span><span class="n">ix_map</span><span class="p">[</span><span class="n">idx</span><span class="p">]][</span><span class="s2">&quot;Text&quot;</span><span class="p">]</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                            <span class="s2">&quot;Point index not found. No point diagnostic to show.&quot;</span>
                        <span class="p">)</span>
                        <span class="k">return</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No forward branch to show the diagnostic for.&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ix_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_index_map</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="o">-</span><span class="n">idx</span> <span class="ow">in</span> <span class="n">ix_map</span><span class="p">:</span>
                        <span class="k">return</span> <span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span>
                            <span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="o">.</span><span class="n">diagnostics</span><span class="p">[</span><span class="n">ix_map</span><span class="p">[</span><span class="o">-</span><span class="n">idx</span><span class="p">]][</span><span class="s2">&quot;Text&quot;</span><span class="p">]</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                            <span class="s2">&quot;Point index not found. No point diagnostic to show.&quot;</span>
                        <span class="p">)</span>
                        <span class="k">return</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No backward branch to show the diagnostic for.&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Continuation.print_point_diagnostic">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.print_point_diagnostic">[docs]</a>
    <span class="k">def</span> <span class="nf">print_point_diagnostic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method which prints the diagnostic of a given point of the continuation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        idx: str or int</span>
<span class="sd">            |AUTO| index of the point to give the diagnostic from.</span>
<span class="sd">            If `idx`:</span>

<span class="sd">            * is a string, it should identify the label of the point, assuming the</span>
<span class="sd">              point has a label. Backward continuation label must be preceded by</span>
<span class="sd">              a `&#39;-&#39;` character. E.g. `&#39;HB2&#39;` would identify the second Hopf bifurcation</span>
<span class="sd">              point of the forward continuation, while `&#39;-UZ3&#39;` identifies the third</span>
<span class="sd">              user-defined label of the backward branch.</span>
<span class="sd">            * is an integer, it corresponds to the index of the point. Positive</span>
<span class="sd">              integers identify points on the forward continuation, while negative integers</span>
<span class="sd">              identify points on the backward continuation. The zero index identifies the</span>
<span class="sd">              initial point of the continuations.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point_diagnostic</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span></div>


<div class="viewcode-block" id="Continuation.find_solution_index">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.find_solution_index">[docs]</a>
    <span class="k">def</span> <span class="nf">find_solution_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find the index of a given solution label.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label: str</span>
<span class="sd">            A string with the label of the point for which to return the solution object.</span>
<span class="sd">            Backward continuation label must be preceded by a `&#39;-&#39;` character. E.g. `&#39;HB2&#39;`</span>
<span class="sd">            identifies the second Hopf bifurcation point of the forward continuation,</span>
<span class="sd">            while `&#39;-UZ3&#39;` identifies the third user-defined label of the backward branch.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The AUTO index of the provided label.</span>
<span class="sd">            Positive integers identify points on the forward</span>
<span class="sd">            continuation, while negative integers identify points on the backward</span>
<span class="sd">            continuation.</span>
<span class="sd">            The zero index identifies the initial point of the continuations.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_solution_by_label</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span><span class="p">[</span><span class="s2">&quot;PT&quot;</span><span class="p">]</span></div>


    <span class="k">def</span> <span class="nf">_find_solution_python_auto_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_label</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                    <span class="n">tgt</span> <span class="o">=</span> <span class="n">label</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
                    <span class="n">sn</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">label</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">la</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_label</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">la</span> <span class="o">==</span> <span class="n">tgt</span><span class="p">:</span>
                            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="n">sn</span><span class="p">:</span>
                            <span class="k">break</span>
                        <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No solution found.&quot;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="kc">None</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_python_auto_index</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_label</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">tgt</span> <span class="o">=</span> <span class="n">label</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
                    <span class="n">sn</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">label</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">la</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_label</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">la</span> <span class="o">==</span> <span class="n">tgt</span><span class="p">:</span>
                            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="n">sn</span><span class="p">:</span>
                            <span class="k">break</span>
                        <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No solution found.&quot;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="kc">None</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_python_auto_index</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_parse_diagnostic</span><span class="p">(</span><span class="n">diag</span><span class="p">):</span>
        <span class="c1"># Extract Point Number from text</span>
        <span class="n">extracted_vals</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="n">lines</span> <span class="o">=</span> <span class="n">diag</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\s{1,}&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>
        <span class="n">val_num</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">pt_num</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;Multiplier&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
                    <span class="c1"># Assumes a split array of [BR, PT, &quot;Multiplier&quot;, multiplier num, FM_re, FM_im, &quot;Abs.&quot;, &quot;Val&quot;, ab_val]</span>
                    <span class="k">if</span> <span class="n">pt_num</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">pt_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">pt_num</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Cannot find consistent Point Number&quot;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">val_num</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]):</span>
                        <span class="c1"># In the case that some numbers are passed as Fortran HUGE(1.0D0), we try two methods to take floats</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">re_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
                        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^-?\d+(\.\d+)?[+-]\d+$&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]):</span>
                                <span class="n">re_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([+-]\d+)$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;e\1&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;unexpected form of float&quot;</span><span class="p">)</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">im_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
                        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^-?\d+(\.\d+)?[+-]\d+$&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">]):</span>
                                <span class="n">im_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([+-]\d+)$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;e\1&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;unexpected form of float&quot;</span><span class="p">)</span>

                        <span class="n">extracted_vals</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">re_val</span><span class="p">,</span> <span class="n">im_val</span><span class="p">])</span>
                        <span class="n">val_num</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">elif</span> <span class="s2">&quot;Eigenvalue&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                    <span class="c1"># Assumes a split array of [BR, PT, &quot;Multiplier&quot;, multiplier num&quot;:&quot;, lambda_re, lambda_im]</span>
                    <span class="k">if</span> <span class="n">pt_num</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">pt_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">pt_num</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Cannot find consistent Point Number&quot;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">val_num</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="c1"># In the case that some numbers are passed as Fortran HUGE(1.0D0), we try two methods to take floats</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">re_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
                        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^-?\d+(\.\d+)?[+-]\d+$&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]):</span>
                                <span class="n">re_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([+-]\d+)$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;e\1&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;unexpected form of float&quot;</span><span class="p">)</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">im_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
                        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^-?\d+(\.\d+)?[+-]\d+$&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">]):</span>
                                <span class="n">im_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([+-]\d+)$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;e\1&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;unexpected form of float&quot;</span><span class="p">)</span>

                        <span class="n">extracted_vals</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">re_val</span><span class="p">,</span> <span class="n">im_val</span><span class="p">])</span>
                        <span class="n">val_num</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">continue</span>

        <span class="c1"># if pt_num has not been updated, attempt to update it using the first row of data:</span>
        <span class="k">if</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;PT&quot;</span><span class="p">:</span>
            <span class="n">pt_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">extracted_vals</span><span class="p">,</span> <span class="n">pt_num</span>

    <span class="k">def</span> <span class="nf">_solutions_index_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;forward&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function creates a map between the `Point number` as found in the solution file, and the `Point number` in the diagnostic d. file.</span>
<span class="sd">        It was found that when AUTO cannot converge, it still logs the point and the d. file index then does not correspond with the sol file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ix_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">diag_data</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">diagnostics</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">diag_data</span><span class="p">):</span>
                <span class="n">stab_vals</span><span class="p">,</span> <span class="n">pt_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_diagnostic</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;Text&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">diag_data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">dd</span> <span class="o">=</span> <span class="n">diag_data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">stab_vals_next</span><span class="p">,</span> <span class="n">pt_num_next</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_diagnostic</span><span class="p">(</span><span class="n">dd</span><span class="p">[</span><span class="s2">&quot;Text&quot;</span><span class="p">])</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stab_vals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">pt_num</span> <span class="o">!=</span> <span class="n">pt_num_next</span><span class="p">:</span>
                        <span class="n">ix_map</span><span class="p">[</span><span class="n">pt_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Catch to compare final entry of diagnostic</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stab_vals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">ix_map</span><span class="p">[</span><span class="n">pt_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="k">return</span> <span class="n">ix_map</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stability</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;dict(list): The stability information of both forward and backward continuations.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="s2">&quot;backward&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">s</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stability</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">s</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">s</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;dict(int): The number of points of both forward and backward continuations.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="s2">&quot;backward&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">n</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stability</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">n</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">return</span> <span class="n">n</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">continuation_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;dict(list(str)): The continuation parameters of both forward and backward continuations.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;ICP&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;ICP&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">solutions_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;dict(list(int)): The indices of all the solutions of both forward and backward continuations.&quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_list_by_direction</span>
        <span class="n">rd</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rd</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">sol</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]:</span>
                <span class="n">idx_pt</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="s2">&quot;PT&quot;</span><span class="p">]</span>
                <span class="n">rd</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">idx_pt</span><span class="p">))</span>
            <span class="n">rd</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">sol</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]:</span>
                <span class="n">idx_pt</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="s2">&quot;PT&quot;</span><span class="p">]</span>
                <span class="n">rd</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">idx_pt</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">rd</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_solutions_python_auto_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">getIndices</span><span class="p">()</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">getIndices</span><span class="p">()</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">d</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">solutions_label</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;dict(list(str)): The labels of all the solutions of both forward and backward continuations.&quot;&quot;&quot;</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_python_auto_index</span>
        <span class="k">if</span> <span class="n">indices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">indices</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]:</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span>
                <span class="n">sl</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">:</span>
                    <span class="n">sl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="nb">str</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span>
                            <span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">by_index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                        <span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sl</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">indices</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]:</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span>
                <span class="n">sl</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">:</span>
                    <span class="n">sl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="nb">str</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span>
                            <span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">by_index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                        <span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sl</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">d</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_solutions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;dict(int): The number of solutions of both forward and backward continuations.&quot;&quot;&quot;</span>
        <span class="n">sd</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">sols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_list_by_direction</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="s2">&quot;backward&quot;</span><span class="p">]:</span>
                <span class="n">sd</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sols</span><span class="p">[</span><span class="n">direction</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">sd</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">full_solutions_list_by_label</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;list(AUTOSolution object): The full list of solutions sorted by labels of both forward and backward continuations.&quot;&quot;&quot;</span>
        <span class="n">sd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_list_by_direction_and_by_label</span>
        <span class="k">if</span> <span class="n">sd</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]:</span>
            <span class="n">sl</span> <span class="o">=</span> <span class="n">sd</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sl</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">sd</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]:</span>
            <span class="n">sl</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sd</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">sl</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">full_solutions_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;list(AUTOSolution object): The full list of solutions of the branch ordered from the last solution of the backward</span>
<span class="sd">        continuation to the last solution of the forward continuation.&quot;&quot;&quot;</span>
        <span class="n">sd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_list_by_direction</span>
        <span class="k">if</span> <span class="n">sd</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_label</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;EP&quot;</span><span class="p">:</span>
                <span class="n">sl</span> <span class="o">=</span> <span class="n">sd</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sl</span> <span class="o">=</span> <span class="n">sd</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sl</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">sd</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]:</span>
            <span class="n">sl</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sd</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">sl</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">solutions_list_by_direction_and_by_label</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;dict(list(AUTOSolution object)): The full list of solutions sorted by labels and direction for both forward</span>
<span class="sd">        and backward continuations.&quot;&quot;&quot;</span>
        <span class="n">sd</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sd</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="n">sd</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">lab_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">lab</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_label</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">lab</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">lab_list</span><span class="p">:</span>
                        <span class="n">lab_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lab</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">lab</span> <span class="ow">in</span> <span class="n">lab_list</span><span class="p">:</span>
                    <span class="n">sd</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">getLabel</span><span class="p">(</span><span class="n">lab</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">lab_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">lab</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_label</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">lab</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">lab_list</span><span class="p">:</span>
                        <span class="n">lab_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lab</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">lab</span> <span class="ow">in</span> <span class="n">lab_list</span><span class="p">:</span>
                    <span class="n">sd</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">getLabel</span><span class="p">(</span><span class="n">lab</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">sd</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">solutions_list_by_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;dict(list(AUTOSolution object)): The full list of solutions sorted by direction for both</span>
<span class="sd">        forward and backward continuations.&quot;&quot;&quot;</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_python_auto_index</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_label</span>
        <span class="n">sd</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">indices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sd</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="n">sd</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">lab</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">],</span> <span class="n">indices</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="s2">&quot;solution&quot;</span>
                        <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span>
                        <span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">by_index</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">lab</span><span class="p">]</span>
                    <span class="p">):</span>
                        <span class="n">sol</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span>
                            <span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">by_index</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">lab</span><span class="p">][</span><span class="s2">&quot;solution&quot;</span><span class="p">]</span>
                        <span class="p">)</span>
                        <span class="n">sd</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">lab</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">],</span> <span class="n">indices</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="s2">&quot;solution&quot;</span>
                        <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span>
                        <span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">by_index</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">lab</span><span class="p">]</span>
                    <span class="p">):</span>
                        <span class="n">sol</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span>
                            <span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">by_index</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">lab</span><span class="p">][</span><span class="s2">&quot;solution&quot;</span><span class="p">]</span>
                        <span class="p">)</span>
                        <span class="n">sd</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sd</span>

<div class="viewcode-block" id="Continuation.solutions_parameters">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.solutions_parameters">[docs]</a>
    <span class="k">def</span> <span class="nf">solutions_parameters</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">parameters</span><span class="p">,</span>
        <span class="n">solutions_types</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;HB&quot;</span><span class="p">,</span> <span class="s2">&quot;BP&quot;</span><span class="p">,</span> <span class="s2">&quot;UZ&quot;</span><span class="p">,</span> <span class="s2">&quot;PD&quot;</span><span class="p">,</span> <span class="s2">&quot;TR&quot;</span><span class="p">,</span> <span class="s2">&quot;LP&quot;</span><span class="p">),</span>
        <span class="n">forward</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the parameters value for the solutions of the backward and forward continuations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parameters: list(str)</span>
<span class="sd">            The parameters to be returned.</span>
<span class="sd">        solutions_types: list(str), optional</span>
<span class="sd">            The types of solution to consider in the search.</span>
<span class="sd">            Default to `[&#39;HB&#39;, &#39;BP&#39;, &#39;UZ&#39;, &#39;PD&#39;, &#39;TR&#39;, &#39;LP&#39;]`.</span>
<span class="sd">        forward: bool or None, optional</span>
<span class="sd">            If `True`, search only in the forward continuation.</span>
<span class="sd">            If `False`, search only in the backward continuation.</span>
<span class="sd">            If `None`, search in both backward and forward direction.</span>
<span class="sd">            Default to `None`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ~numpy.ndarray</span>
<span class="sd">            The values of the requested solutions parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span><span class="n">parameters</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solutions_types</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="n">sl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_filtered_solutions_list</span><span class="p">(</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">solutions_types</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="n">forward</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solutions_types</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">solutions_types</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">forward</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">sl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_solutions_list</span>
                <span class="k">elif</span> <span class="n">forward</span><span class="p">:</span>
                    <span class="n">sl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_list_by_direction</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_list_by_direction</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_solutions_list</span>
        <span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
            <span class="n">par_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sl</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">par_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">param</span><span class="p">]))</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="n">par_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">param</span><span class="p">]))</span>
            <span class="n">params</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">par_list</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Continuation.points_parameters">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.points_parameters">[docs]</a>
    <span class="k">def</span> <span class="nf">points_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the value of a parameter for all the continuation points of the backward and forward continuations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parameter: str</span>
<span class="sd">            The parameters to be returned.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict(~numpy.ndarray)</span>
<span class="sd">            The parameter values of the all the continuation points.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">,</span> <span class="s2">&quot;forward&quot;</span><span class="p">]:</span>
            <span class="n">params</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">params</span></div>


<div class="viewcode-block" id="Continuation.get_solution_by_label">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.get_solution_by_label">[docs]</a>
    <span class="k">def</span> <span class="nf">get_solution_by_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the |AUTO| solution object corresponding to a given label.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label: str</span>
<span class="sd">            A string with the label of the point for which to return the solution object.</span>
<span class="sd">            Backward continuation label must be preceded by a `&#39;-&#39;` character. E.g. `&#39;HB2&#39;`</span>
<span class="sd">            identifies the second Hopf bifurcation point of the forward continuation,</span>
<span class="sd">            while `&#39;-UZ3&#39;` identifies the third user-defined label of the backward branch.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        AUTOSolution object</span>
<span class="sd">            The sought AUTO solution object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">getLabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;-&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">getLabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Continuation.get_solution_by_index">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.get_solution_by_index">[docs]</a>
    <span class="k">def</span> <span class="nf">get_solution_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the |AUTO| solution object corresponding to a index.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        idx: int</span>
<span class="sd">            The index of the point. Positive integers identify points on the forward</span>
<span class="sd">            continuation, while negative integers identify points on the backward</span>
<span class="sd">            continuation.</span>
<span class="sd">            The zero index identifies the initial point of the continuations.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        AUTOSolution object</span>
<span class="sd">            The sought AUTO solution object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">:</span>
            <span class="n">sd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_list_by_direction</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sd</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="s2">&quot;PT&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">idx</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">s</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Solution for index </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sd</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="s2">&quot;PT&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">abs</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">s</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Solution for index </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Continuation.get_filtered_solutions_list">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.get_filtered_solutions_list">[docs]</a>
    <span class="k">def</span> <span class="nf">get_filtered_solutions_list</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">indices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">forward</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">tol</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the full solutions list of the branch with different selection rules:</span>
<span class="sd">        * Based on solution labels</span>
<span class="sd">        * Based on solution indices</span>
<span class="sd">        * Based matching solution parameters values with a specified list of values</span>

<span class="sd">        Selection rules are selected by specifying a given keyword.</span>
<span class="sd">        If no selection rule is provided, return the full list of solution in the selected direction(s).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        labels: str or list(str), optional</span>
<span class="sd">            Label or list of labels to look for the solutions. Labels are two-characters string specifying the solutions types to return.</span>
<span class="sd">            For example `&#39;BP&#39;` will return all the branching points of the continuations.</span>
<span class="sd">            This activates the selection rule based on labels and disable the others.</span>
<span class="sd">        indices: int or list(int), optional</span>
<span class="sd">            Index or list of indices to look for the solutions. AUTO index of solutions can be inquired for example by calling the</span>
<span class="sd">            :meth:`print_summary` method of a given :class:`Continuation` object.</span>
<span class="sd">            This activates the selection rule based on indices and disable the others.</span>
<span class="sd">        parameters: str or list(str) or ~numpy.ndarray(str), optional</span>
<span class="sd">            Parameter or list of parameters for which to match the solutions values to one provided by the `values` argument.</span>
<span class="sd">        values: float or list(float) or ~numpy.ndarray(float), optional</span>
<span class="sd">            List of parameters values to match to the solutions parameters values.</span>
<span class="sd">            Can be a float if only one parameter is specified in the `parameters` arguments, otherwise a list or a :class:`~numpy.ndarray` array</span>
<span class="sd">            must be provided.</span>
<span class="sd">            If a list is provided, assuming `n` parameters were specified in the `parameters` argument</span>
<span class="sd">            and`m` values are sought, it should be a nested list with the following structure:</span>
<span class="sd">            `[[param1_value1, param1_value2, ..., param1_valuem], ..., [paramn_value1, paramn_value2, ..., paramn_valuem]]`</span>
<span class="sd">            If a :class:`~numpy.ndarray` array is provided, with the same assumptions, it should be a 2-D array with shape (n, m) with the</span>
<span class="sd">            parameters values.</span>
<span class="sd">        forward: bool or None, optional</span>
<span class="sd">            If `True`, search only in the forward continuation.</span>
<span class="sd">            If `False`, search only in the backward continuation.</span>
<span class="sd">            If `None`, search in both backward and forward direction.</span>
<span class="sd">            Default to `None`.</span>
<span class="sd">        tol: float or list(float) or ~numpy.ndarray(float), optional</span>
<span class="sd">            The numerical tolerance of the values comparison if the selection rule based on parameters values is activated</span>
<span class="sd">            (by setting the arguments `parameters` and `values`).</span>
<span class="sd">            If a single float is provided, assume the same tolerance for each parameter.</span>
<span class="sd">            If a list or a 1-D array is passed, it must have the dimension of the number of parameters, each value in the</span>
<span class="sd">            array corresponding to a parameter.</span>
<span class="sd">            Default to `0.01`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list(AUTOSolution objects):</span>
<span class="sd">            A list of the sought solutions</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="n">parameters</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">parameters</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">parameters</span><span class="p">)[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span> <span class="o">*</span> <span class="n">parameters</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                        <span class="s2">&quot;Wrong number of values provided for the number of parameters test requested.&quot;</span>
                    <span class="p">)</span>
                    <span class="k">return</span> <span class="nb">list</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No values provided for the parameters specified.&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="nb">list</span><span class="p">()</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tol</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="n">tol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tol</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tol</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                <span class="n">tol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tol</span><span class="p">]</span> <span class="o">*</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tol</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">forward</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">solutions_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_solutions_list</span>
        <span class="k">elif</span> <span class="n">forward</span><span class="p">:</span>
            <span class="n">solutions_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_list_by_direction</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">solutions_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_list_by_direction</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">labels</span><span class="p">]</span>
            <span class="n">new_solutions_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">sol</span> <span class="ow">in</span> <span class="n">solutions_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sol</span><span class="p">[</span><span class="s2">&quot;TY&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
                    <span class="n">new_solutions_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
            <span class="n">solutions_list</span> <span class="o">=</span> <span class="n">new_solutions_list</span>
        <span class="k">elif</span> <span class="n">indices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">indices</span><span class="p">]</span>
            <span class="n">new_solutions_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">sol</span> <span class="ow">in</span> <span class="n">solutions_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sol</span><span class="p">[</span><span class="s2">&quot;PT&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                    <span class="n">new_solutions_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
            <span class="n">solutions_list</span> <span class="o">=</span> <span class="n">new_solutions_list</span>
        <span class="k">elif</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_solutions_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">sol</span> <span class="ow">in</span> <span class="n">solutions_list</span><span class="p">:</span>
                    <span class="n">sol_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">parameters</span><span class="p">):</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="n">param</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                            <span class="n">sol_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="n">param</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">sol_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="n">param</span><span class="p">])</span>
                    <span class="n">diff</span> <span class="o">=</span> <span class="n">sol_val</span> <span class="o">-</span> <span class="n">val</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">):</span>
                        <span class="n">new_solutions_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
            <span class="n">solutions_list</span> <span class="o">=</span> <span class="n">new_solutions_list</span>

        <span class="k">return</span> <span class="n">solutions_list</span></div>


<div class="viewcode-block" id="Continuation.plot_branch_parts">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.plot_branch_parts">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_branch_parts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">variables</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mf">12.0</span><span class="p">,</span>
        <span class="n">plot_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">marker_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">excluded_labels</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;UZ&quot;</span><span class="p">,</span> <span class="s2">&quot;EP&quot;</span><span class="p">),</span>
        <span class="n">plot_sol_points</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">variables_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">solutions_types</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;HB&quot;</span><span class="p">,</span> <span class="s2">&quot;BP&quot;</span><span class="p">,</span> <span class="s2">&quot;UZ&quot;</span><span class="p">,</span> <span class="s2">&quot;PD&quot;</span><span class="p">,</span> <span class="s2">&quot;TR&quot;</span><span class="p">,</span> <span class="s2">&quot;LP&quot;</span><span class="p">),</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots a bifurcation diagram  along specified variables, with branches and the bifurcation points</span>
<span class="sd">        of fixed points and periodic orbits.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        variables: tuple(int or str, int or str), optional</span>
<span class="sd">            The index or label of the variables along which the bifurcation diagram is plotted.</span>
<span class="sd">            If labels are used, it should be labels of the available monitored variables during the continuations</span>
<span class="sd">            (if their labels have been defined in the AUTO configuration file) given by :meth:`available_variables`.</span>
<span class="sd">            The first value in the tuple determines the variable plot on the x-axis and the second the y-axis.</span>
<span class="sd">            Defaults to `(0, 1)`.</span>
<span class="sd">        ax: matplotlib.axes.Axes or None, optional</span>
<span class="sd">            A |Matplotlib| axis object to plot on. If `None`, a new figure is created.</span>
<span class="sd">        figsize: tuple(float, float), optional</span>
<span class="sd">            Dimension of the figure that is returned, only used if `ax` is not passed.</span>
<span class="sd">            Defaults to `(10, 8)`.</span>
<span class="sd">        markersize: float, optional</span>
<span class="sd">            Size of the text plotted to display the bifurcation points. Defaults to `12`.</span>
<span class="sd">        plot_kwargs: dict or None, optional</span>
<span class="sd">            Optional key word arguments to pass to the plotting function, controlling the curves of the bifurcation diagram.</span>
<span class="sd">        marker_kwargs: dict or None, optional</span>
<span class="sd">            Optional key word arguments to pass to the plotting function, controlling the styles of the bifurcation point labels.</span>
<span class="sd">        excluded_labels: str or list(str), optional</span>
<span class="sd">            A list of 2-characters strings, controlling the bifurcation point type that are not plotted.</span>
<span class="sd">            For example `[&#39;BP&#39;]` will result in branching points not being plotted.</span>
<span class="sd">            Can be set to the string `&#39;all&#39;`, which results in no bifurcation being plotted at all.</span>
<span class="sd">            Default to `[&#39;UZ&#39;,&#39;EP&#39;]`.</span>
<span class="sd">        plot_sol_points: bool, optional</span>
<span class="sd">            If `True`, a point is added to the points where a solution is stored. Defaults to False.</span>
<span class="sd">        variables_name: list(str) or None, optional</span>
<span class="sd">            The strings used to define the axis labels. If `None` defaults to the AUTO labels.</span>
<span class="sd">        cmap: cmap or None, optional</span>
<span class="sd">            The cmap used for plotting in case `plot_sol_points` is `True`. If `None`, defaults to &#39;Reds&#39;</span>
<span class="sd">        solutions_types: list(str), optional</span>
<span class="sd">            The types of solution to plot if `plot_sol_points` is `True`.</span>
<span class="sd">            Default to `[&#39;HB&#39;, &#39;BP&#39;, &#39;UZ&#39;, &#39;PD&#39;, &#39;TR&#39;, &#39;LP&#39;]`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        matplotlib.axes.Axes</span>
<span class="sd">            A |Matplotlib| axis object showing the bifurcation diagram using a 3-dimensional projection.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">plot_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">marker_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">marker_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="nb">vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_variables</span>

        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span>
                    <span class="n">var1</span> <span class="o">=</span> <span class="n">var</span>
                    <span class="k">break</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">var1</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">var1</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span>
                    <span class="n">var2</span> <span class="o">=</span> <span class="n">var</span>
                    <span class="k">break</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">var2</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">var2</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">plot_sol_points</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;Reds&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="s2">&quot;backward&quot;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">coords</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                    <span class="nb">zip</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">][</span><span class="n">var1</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">][</span><span class="n">var2</span><span class="p">],</span>
                    <span class="p">)</span>
                <span class="p">):</span>
                    <span class="n">lab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getIndex</span><span class="p">(</span><span class="n">j</span><span class="p">)[</span><span class="s2">&quot;TY name&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">lab</span> <span class="o">==</span> <span class="s2">&quot;No Label&quot;</span><span class="p">:</span>
                        <span class="k">pass</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">coords</span><span class="p">,</span> <span class="n">lab</span><span class="p">))</span>

                <span class="n">pidx</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stability</span><span class="p">[</span><span class="n">direction</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span>
                    <span class="n">plot_kwargs</span><span class="p">[</span><span class="s2">&quot;linestyle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ls</span>
                    <span class="n">lines_list</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">][</span><span class="n">var1</span><span class="p">][</span><span class="n">pidx</span> <span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">idx</span><span class="p">)],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">][</span><span class="n">var2</span><span class="p">][</span><span class="n">pidx</span> <span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">idx</span><span class="p">)],</span>
                        <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="n">lines_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">()</span>
                    <span class="n">plot_kwargs</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
                    <span class="n">pidx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">excluded_labels</span> <span class="o">!=</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
                        <span class="n">coords</span> <span class="o">=</span> <span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">lab</span> <span class="o">=</span> <span class="n">label</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">lab</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">excluded_labels</span><span class="p">:</span>
                            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                                <span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                <span class="sa">r</span><span class="s2">&quot;${\bf &quot;</span> <span class="o">+</span> <span class="n">lab</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;}$&quot;</span><span class="p">,</span>
                                <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;family&quot;</span><span class="p">:</span> <span class="s2">&quot;sans-serif&quot;</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">markersize</span><span class="p">},</span>
                                <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                                <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                                <span class="o">**</span><span class="n">marker_kwargs</span><span class="p">,</span>
                                <span class="n">clip_on</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="p">)</span>

        <span class="k">if</span> <span class="n">plot_sol_points</span><span class="p">:</span>
            <span class="c1"># generate points and colours for plotting</span>
            <span class="n">p_vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_parameters</span><span class="p">(</span>
                <span class="n">parameters</span><span class="o">=</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span> <span class="n">var2</span><span class="p">),</span> <span class="n">solutions_types</span><span class="o">=</span><span class="n">solutions_types</span>
            <span class="p">)</span>
            <span class="n">x_vals</span> <span class="o">=</span> <span class="n">p_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">y_vals</span> <span class="o">=</span> <span class="n">p_vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_vals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">p_min</span><span class="p">,</span> <span class="n">p_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x_vals</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x_vals</span><span class="p">)</span>
                <span class="n">point_color</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">cmap</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">p_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">p_max</span> <span class="o">-</span> <span class="n">p_min</span><span class="p">)),</span> <span class="n">x_vals</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">point_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No solution found to plot as points.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">variables_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">var1</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">var2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variables_name</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="n">var1</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="n">var2</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="Continuation.plot_branch_parts_3D">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.plot_branch_parts_3D">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_branch_parts_3D</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">variables</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
        <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mf">12.0</span><span class="p">,</span>
        <span class="n">plot_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">marker_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">excluded_labels</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;UZ&quot;</span><span class="p">,</span> <span class="s2">&quot;EP&quot;</span><span class="p">),</span>
        <span class="n">variables_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots a bifurcation diagram on a 3-dimensional figure along specified variables, with branches and the bifurcation points</span>
<span class="sd">        of fixed points and periodic orbits.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        variables: tuple(int or str, int or str, int or str), optional</span>
<span class="sd">            The index or label of the variables along which the bifurcation diagram is plotted.</span>
<span class="sd">            If labels are used, it should be labels of the available monitored variables during the continuations</span>
<span class="sd">            (if their labels have been defined in the AUTO configuration file) given by :meth:`available_variables`.</span>
<span class="sd">            The first value in the tuple determines the variable plot on the x-axis, the second the y-axis, and the third value determines the z-axis.</span>
<span class="sd">            Defaults to `(0, 1, 2)`.</span>
<span class="sd">        ax: matplotlib.axes.Axes or None, optional</span>
<span class="sd">            A |Matplotlib| axis object to plot on. If `None`, a new figure is created.</span>
<span class="sd">        figsize: tuple(float, float), optional</span>
<span class="sd">            Dimension of the figure that is returned, only used if `ax` is not passed.</span>
<span class="sd">            Defaults to `(10, 8)`.</span>
<span class="sd">        markersize: float, optional</span>
<span class="sd">            Size of the text plotted to display the bifurcation points. Defaults to `12.`.</span>
<span class="sd">        plot_kwargs: dict or None, optional</span>
<span class="sd">            Optional key word arguments to pass to the plotting function, controlling the curves of the bifurcation diagram.</span>
<span class="sd">        marker_kwargs: dict or None, optional</span>
<span class="sd">            Optional key word arguments to pass to the plotting function, controlling the styles of the bifurcation point labels.</span>
<span class="sd">        excluded_labels: str or list(str), optional</span>
<span class="sd">            A list of 2-characters strings, controlling the bifurcation point type that are not plotted.</span>
<span class="sd">            For example `[&#39;BP&#39;]` will result in branching points not being plotted.</span>
<span class="sd">            Can be set to the string `&#39;all&#39;`, which results in no bifurcation being plotted at all.</span>
<span class="sd">            Default to `[&#39;UZ&#39;,&#39;EP&#39;]`.</span>
<span class="sd">        variables_name: list(str) or None, optional</span>
<span class="sd">            The strings used to define the axis labels. If `None` defaults to the AUTO labels.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        matplotlib.axes.Axes</span>
<span class="sd">            A |Matplotlib| axis object showing the bifurcation diagram using a 3-dimensional projection.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">plot_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">marker_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">marker_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="nb">vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_variables</span>

        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span>
                    <span class="n">var1</span> <span class="o">=</span> <span class="n">var</span>
                    <span class="k">break</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">var1</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">var1</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span>
                    <span class="n">var2</span> <span class="o">=</span> <span class="n">var</span>
                    <span class="k">break</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">var2</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">var2</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">variables</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span>
                    <span class="n">var3</span> <span class="o">=</span> <span class="n">var</span>
                    <span class="k">break</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">var3</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="n">variables</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">var3</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="s2">&quot;backward&quot;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">coords</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                    <span class="nb">zip</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">][</span><span class="n">var1</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">][</span><span class="n">var2</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">][</span><span class="n">var3</span><span class="p">],</span>
                    <span class="p">)</span>
                <span class="p">):</span>
                    <span class="n">lab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getIndex</span><span class="p">(</span><span class="n">j</span><span class="p">)[</span><span class="s2">&quot;TY name&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">lab</span> <span class="o">==</span> <span class="s2">&quot;No Label&quot;</span><span class="p">:</span>
                        <span class="k">pass</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">coords</span><span class="p">,</span> <span class="n">lab</span><span class="p">))</span>

                <span class="n">pidx</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stability</span><span class="p">[</span><span class="n">direction</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span>
                    <span class="n">plot_kwargs</span><span class="p">[</span><span class="s2">&quot;linestyle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ls</span>
                    <span class="n">lines_list</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">][</span><span class="n">var1</span><span class="p">][</span><span class="n">pidx</span> <span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">idx</span><span class="p">)],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">][</span><span class="n">var2</span><span class="p">][</span><span class="n">pidx</span> <span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">idx</span><span class="p">)],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="n">direction</span><span class="p">][</span><span class="n">var3</span><span class="p">][</span><span class="n">pidx</span> <span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">idx</span><span class="p">)],</span>
                        <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="n">lines_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">()</span>
                    <span class="n">plot_kwargs</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
                    <span class="n">pidx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">excluded_labels</span> <span class="o">!=</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
                        <span class="n">coords</span> <span class="o">=</span> <span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">lab</span> <span class="o">=</span> <span class="n">label</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">lab</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">excluded_labels</span><span class="p">:</span>
                            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                                <span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                <span class="n">coords</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                <span class="sa">r</span><span class="s2">&quot;${\bf &quot;</span> <span class="o">+</span> <span class="n">lab</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;}$&quot;</span><span class="p">,</span>
                                <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;family&quot;</span><span class="p">:</span> <span class="s2">&quot;sans-serif&quot;</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">markersize</span><span class="p">},</span>
                                <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                                <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                                <span class="o">**</span><span class="n">marker_kwargs</span><span class="p">,</span>
                                <span class="n">clip_on</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="p">)</span>

        <span class="k">if</span> <span class="n">variables_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">var1</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">var2</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="n">var3</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variables_name</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="n">var1</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="n">var2</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="n">var3</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="Continuation.plot_solutions">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.plot_solutions">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_solutions</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">variables</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="n">markersize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">color_solutions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">plot_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">indices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">parameter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">variables_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">tol</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots the stored solutions for a given set of variables. Fixed points are plotted using points, periodic orbits are plot as curves.</span>
<span class="sd">        Solutions that are plotted are filtered here using the selection rule-based :meth:`get_filtered_solutions_list` method.</span>
<span class="sd">        However, if no selection rule is provided, it will plot all the solutions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        variables: tuple(int or str, int or str), optional</span>
<span class="sd">            The index or label of the variables shown in the plot.</span>
<span class="sd">            If labels are used, it should be labels of the phase space variables</span>
<span class="sd">            (if they have been defined in the AUTO configuration file) given by :meth:`phase_space_variables`.</span>
<span class="sd">            The first value in the tuple determines the variable plot on the x-axis, the second determines the y-axis.</span>
<span class="sd">            Defaults to the first two variables: `(0, 1)`.</span>
<span class="sd">        ax: matplotlib.axes.Axes or None, optional</span>
<span class="sd">            A |Matplotlib| axis object to plot on. If `None`, a new figure is created.</span>
<span class="sd">        figsize: figsize: tuple(float, float), optional</span>
<span class="sd">            Dimension of the figure that is returned, only used if `ax` is not passed.</span>
<span class="sd">            Defaults to `(10, 8)`.</span>
<span class="sd">        markersize: float, optional</span>
<span class="sd">            Size of the text plotted to display the bifurcation points. Defaults to `12`.</span>
<span class="sd">        marker : str, optional</span>
<span class="sd">            The marker style used for plotting fixed points. If `None`, set to default marker.</span>
<span class="sd">        linestyle: str, optional</span>
<span class="sd">            The line style used for plotting the periodic orbit solutions. If `None`, set to default marker.</span>
<span class="sd">        linewidth: float, optional</span>
<span class="sd">            The width of the lines showing the periodic solutions. If `None`, set to the default.</span>
<span class="sd">        color_solutions: bool, optional</span>
<span class="sd">            Whether to color each solution differently. In this case, a valid `parameter` argument must be provided.</span>
<span class="sd">            If `True`, and `parameter` argument is provided and valid, then solutions are colored based on the parameter value of a given solution.</span>
<span class="sd">            Use the cmap provided in the `plot_kwargs` argument. If no cmap is provided there, use `Blues` cmap by default.</span>
<span class="sd">            If `False`, all solutions are colored identically, controlled using `plot_kwargs`.</span>
<span class="sd">            Default is `False`.</span>
<span class="sd">        plot_kwargs: dict or None, optional</span>
<span class="sd">            Additional keyword arguments for the plotting function. Default is `None`.</span>
<span class="sd">        labels: str or list(str), optional</span>
<span class="sd">            **Selection rule to select particular solutions (see** :meth:`get_filtered_solutions_list` **for more details.).**</span>
<span class="sd">            Label or list of labels to look for the solutions. Labels are two-characters string specifying the solutions types to return.</span>
<span class="sd">            For example `&#39;BP&#39;` will return all the branching points of the continuations.</span>
<span class="sd">            This activates the selection rule based on labels and disable the others.</span>
<span class="sd">        indices: int or list(int), optional</span>
<span class="sd">            **Selection rule to select particular solutions (see** :meth:`get_filtered_solutions_list` **for more details.).**</span>
<span class="sd">            Index or list of indices to look for the solutions. AUTO index of solutions can be inquired for example by calling the</span>
<span class="sd">            :meth:`print_summary` method of a given :class:`Continuation` object.</span>
<span class="sd">            This activates the selection rule based on indices and disable the others.</span>
<span class="sd">        parameter: str or list(str) or ~numpy.ndarray(str), optional</span>
<span class="sd">            **Selection rule to select particular solutions (see** :meth:`get_filtered_solutions_list` **for more details.).**</span>
<span class="sd">            Parameter or list of parameters for which to match the solutions values to one provided by the `values` argument.</span>
<span class="sd">        value: float or list(float) or ~numpy.ndarray(float), optional</span>
<span class="sd">            **Selection rule to select particular solutions (see** :meth:`get_filtered_solutions_list` **for more details.).**</span>
<span class="sd">            List of parameters values to match to the solutions parameters values.</span>
<span class="sd">            Can be a float if only one parameter is specified in the `parameters` arguments, otherwise a list or a :class:`~numpy.ndarray` array</span>
<span class="sd">            must be provided.</span>
<span class="sd">            If a list is provided, assuming `n` parameters were specified in the `parameters` argument</span>
<span class="sd">            and`m` values are sought, it should be a nested list with the following structure:</span>
<span class="sd">            `[[param1_value1, param1_value2, ..., param1_valuem], ..., [paramn_value1, paramn_value2, ..., paramn_valuem]]`</span>
<span class="sd">            If a :class:`~numpy.ndarray` array is provided, with the same assumptions, it should be a 2-D array with shape (n, m) with the</span>
<span class="sd">            parameters values.</span>
<span class="sd">        variables_name: list(str) or None, optional</span>
<span class="sd">            The strings used to plot the axis labels. If `None` defaults to the AUTO labels.</span>
<span class="sd">            Defaults to `None`.</span>
<span class="sd">        tol: float or list(float) or ~numpy. ndarray(float), optional</span>
<span class="sd">            The numerical tolerance of the values comparison if the selection rule based on parameters values is activated</span>
<span class="sd">            (by setting the arguments `parameters` and `values`).</span>
<span class="sd">            If a single float is provided, assume the same tolerance for each parameter.</span>
<span class="sd">            If a list or a 1-D array is passed, it must have the dimension of the number of parameters, each value in the</span>
<span class="sd">            array corresponding to a parameter.</span>
<span class="sd">            Default to `0.01`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        matplotlib.axes.Axes</span>
<span class="sd">            A |Matplotlib| axis object with the plot of the solutions.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">markersize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">markersize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_markersize</span>
        <span class="k">if</span> <span class="n">marker</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">marker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_marker</span>
        <span class="k">if</span> <span class="n">linestyle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">linestyle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_linestyle</span>
        <span class="k">if</span> <span class="n">linewidth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">linewidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_linewidth</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">plot_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="c1"># Colouring solutions dependant on parameter value</span>
        <span class="k">if</span> <span class="s2">&quot;cmap&quot;</span> <span class="ow">in</span> <span class="n">plot_kwargs</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">plot_kwargs</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
            <span class="n">plot_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;cmap&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;Blues&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">color_solutions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">parameter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">solutions_types</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">solutions_types</span> <span class="o">=</span> <span class="n">labels</span>
                <span class="n">p_vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_parameters</span><span class="p">(</span>
                    <span class="n">parameters</span><span class="o">=</span><span class="n">parameter</span><span class="p">,</span> <span class="n">solutions_types</span><span class="o">=</span><span class="n">solutions_types</span>
                <span class="p">)</span>
                <span class="n">p_min</span><span class="p">,</span> <span class="n">p_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">p_vals</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">p_vals</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">p_vals</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;If `color_solutions` argument is set to true, you must provide the `parameter` argument as well.&quot;</span>
                <span class="p">)</span>

        <span class="n">solutions_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_filtered_solutions_list</span><span class="p">(</span>
            <span class="n">labels</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tol</span>
        <span class="p">)</span>

        <span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_object</span><span class="o">.</span><span class="n">variables</span>

        <span class="k">if</span> <span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">var1</span> <span class="o">=</span> <span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">var1</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">var1</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">var2</span> <span class="o">=</span> <span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">var2</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">var2</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">sol</span> <span class="ow">in</span> <span class="n">solutions_list</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="n">var1</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="n">var2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">color_solutions</span> <span class="ow">and</span> <span class="p">(</span><span class="n">parameter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">plot_kwargs</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">PAR</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span> <span class="o">-</span> <span class="n">p_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">p_max</span> <span class="o">-</span> <span class="n">p_min</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="n">line_list</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">x</span><span class="p">,</span>
                <span class="n">y</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
                <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">color_solutions</span><span class="p">:</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">line_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">()</span>
                <span class="n">plot_kwargs</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>

        <span class="k">if</span> <span class="n">variables_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">var1</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">var2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variables_name</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="n">var1</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="n">var2</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="Continuation.plot_solutions_3D">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.plot_solutions_3D">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_solutions_3D</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">variables</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
        <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="n">markersize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">plot_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">color_solutions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">indices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">parameter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">variables_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">tol</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots the stored solutions for a given set of variables, using a 3-dimensional projection.</span>
<span class="sd">        Fixed points are plotted using points, periodic orbits are plotted as curves.</span>
<span class="sd">        Solutions that are plotted are filtered here using the selection rule-based :meth:`get_filtered_solutions_list` method.</span>
<span class="sd">        However, if no selection rule is provided, it will plot all the solutions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        variables: tuple(int or str, int or str, int or str), optional</span>
<span class="sd">            The index or label of the variables shown in the plot.</span>
<span class="sd">            If labels are used, it should be labels of the phase space variables</span>
<span class="sd">            (if they have been defined in the AUTO configuration file) given by :meth:`phase_space_variables`.</span>
<span class="sd">            The first value in the tuple determines the variable plot on the x-axis, the second determines the y-axis,</span>
<span class="sd">            and the last value determines the z-axis.</span>
<span class="sd">            Defaults to the first three variables: `(0, 1, 2)`.</span>
<span class="sd">        ax: matplotlib.axes.Axes or None, optional</span>
<span class="sd">            A |Matplotlib| axis object to plot on. If `None`, a new figure is created.</span>
<span class="sd">        figsize: tuple(float, float), optional</span>
<span class="sd">            Dimension of the figure that is returned, only used if `ax` is not passed.</span>
<span class="sd">            Defaults to `(10, 8)`.</span>
<span class="sd">        markersize: float, optional</span>
<span class="sd">            Size of the text plotted to display the bifurcation points. Defaults to `12`.</span>
<span class="sd">        marker : str, optional</span>
<span class="sd">            The marker style used for plotting fixed points. If `None`, set to default marker.</span>
<span class="sd">        linestyle: str, optional</span>
<span class="sd">            The line style used for plotting the periodic orbit solutions. If `None`, set to default marker.</span>
<span class="sd">        linewidth: float, optional</span>
<span class="sd">            The width of the lines showing the periodic solutions. If `None`, set to the default.</span>
<span class="sd">        color_solutions: bool, optional</span>
<span class="sd">            Whether to color each solution differently. In this case, a valid `parameter` argument must be provided.</span>
<span class="sd">            If `True`, and `parameter` argument is provided and valid, then solutions are colored based on the parameter value of a given solution.</span>
<span class="sd">            Use the cmap provided in the `plot_kwargs` argument. If no cmap is provided there, use `Blues` cmap by default.</span>
<span class="sd">            If `False`, all solutions are colored identically, controlled using `plot_kwargs`.</span>
<span class="sd">            Default is `False`.</span>
<span class="sd">        plot_kwargs: dict or None, optional</span>
<span class="sd">            Additional keyword arguments for the plotting function. Default is `None`.</span>
<span class="sd">        labels: str or list(str), optional</span>
<span class="sd">            **Selection rule to select particular solutions (see** :meth:`get_filtered_solutions_list` **for more details.).**</span>
<span class="sd">            Label or list of labels to look for the solutions. Labels are two-characters string specifying the solutions types to return.</span>
<span class="sd">            For example `&#39;BP&#39;` will return all the branching points of the continuations.</span>
<span class="sd">            This activates the selection rule based on labels and disable the others.</span>
<span class="sd">        indices: int or list(int), optional</span>
<span class="sd">            **Selection rule to select particular solutions (see** :meth:`get_filtered_solutions_list` **for more details.).**</span>
<span class="sd">            Index or list of indices to look for the solutions. AUTO index of solutions can be inquired for example by calling the</span>
<span class="sd">            :meth:`print_summary` method of a given :class:`Continuation` object.</span>
<span class="sd">            This activates the selection rule based on indices and disable the others.</span>
<span class="sd">        parameter: str or list(str) or ~numpy.ndarray(str), optional</span>
<span class="sd">            **Selection rule to select particular solutions (see** :meth:`get_filtered_solutions_list` **for more details.).**</span>
<span class="sd">            Parameter or list of parameters for which to match the solutions values to one provided by the `values` argument.</span>
<span class="sd">        value: float or list(float) or ~numpy.ndarray(float), optional</span>
<span class="sd">            **Selection rule to select particular solutions (see** :meth:`get_filtered_solutions_list` **for more details.).**</span>
<span class="sd">            List of parameters values to match to the solutions parameters values.</span>
<span class="sd">            Can be a float if only one parameter is specified in the `parameters` arguments, otherwise a list or a :class:`~numpy.ndarray` array</span>
<span class="sd">            must be provided.</span>
<span class="sd">            If a list is provided, assuming `n` parameters were specified in the `parameters` argument</span>
<span class="sd">            and`m` values are sought, it should be a nested list with the following structure:</span>
<span class="sd">            `[[param1_value1, param1_value2, ..., param1_valuem], ..., [paramn_value1, paramn_value2, ..., paramn_valuem]]`</span>
<span class="sd">            If a :class:`~numpy.ndarray` array is provided, with the same assumptions, it should be a 2-D array with shape (n, m) with the</span>
<span class="sd">            parameters values.</span>
<span class="sd">        variables_name: list(str) or None, optional</span>
<span class="sd">            The strings used to plot the axis labels. If `None` defaults to the AUTO labels.</span>
<span class="sd">            Defaults to `None`.</span>
<span class="sd">        tol: float or list(float) or ~numpy. ndarray(float), optional</span>
<span class="sd">            The numerical tolerance of the values comparison if the selection rule based on parameters values is activated</span>
<span class="sd">            (by setting the arguments `parameters` and `values`).</span>
<span class="sd">            If a single float is provided, assume the same tolerance for each parameter.</span>
<span class="sd">            If a list or a 1-D array is passed, it must have the dimension of the number of parameters, each value in the</span>
<span class="sd">            array corresponding to a parameter.</span>
<span class="sd">            Default to `0.01`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        matplotlib.axes.Axes</span>
<span class="sd">            A |Matplotlib| axis object with the 3-dimensional plot of the solutions.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">markersize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">markersize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_markersize</span>
        <span class="k">if</span> <span class="n">marker</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">marker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_marker</span>
        <span class="k">if</span> <span class="n">linestyle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">linestyle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_linestyle</span>
        <span class="k">if</span> <span class="n">linewidth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">linewidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_linewidth</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">plot_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="c1"># Colouring solutions dependant on parameter value</span>
        <span class="k">if</span> <span class="s2">&quot;cmap&quot;</span> <span class="ow">in</span> <span class="n">plot_kwargs</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">plot_kwargs</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
            <span class="n">plot_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;cmap&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;Blues&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">color_solutions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">parameter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">solutions_types</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">solutions_types</span> <span class="o">=</span> <span class="n">labels</span>
                <span class="n">p_vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_parameters</span><span class="p">(</span>
                    <span class="n">parameters</span><span class="o">=</span><span class="n">parameter</span><span class="p">,</span> <span class="n">solutions_types</span><span class="o">=</span><span class="n">solutions_types</span>
                <span class="p">)</span>
                <span class="n">p_min</span><span class="p">,</span> <span class="n">p_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">p_vals</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">p_vals</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">p_vals</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;If `color_solutions` argument is set to true, you must provide the `parameter` argument as well.&quot;</span>
                <span class="p">)</span>

        <span class="n">solutions_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_filtered_solutions_list</span><span class="p">(</span>
            <span class="n">labels</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tol</span>
        <span class="p">)</span>

        <span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_object</span><span class="o">.</span><span class="n">variables</span>

        <span class="k">if</span> <span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">var1</span> <span class="o">=</span> <span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">var1</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">var1</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">var2</span> <span class="o">=</span> <span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">var2</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">var2</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">variables</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">var3</span> <span class="o">=</span> <span class="n">variables</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">var3</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="n">variables</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">var3</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">sol</span> <span class="ow">in</span> <span class="n">solutions_list</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="n">var1</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="n">var2</span><span class="p">]</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="n">var3</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">color_solutions</span> <span class="ow">and</span> <span class="p">(</span><span class="n">parameter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">plot_kwargs</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">PAR</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span> <span class="o">-</span> <span class="n">p_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">p_max</span> <span class="o">-</span> <span class="n">p_min</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="n">line_list</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">x</span><span class="p">,</span>
                <span class="n">y</span><span class="p">,</span>
                <span class="n">z</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
                <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">line_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">()</span>
            <span class="n">plot_kwargs</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>

        <span class="k">if</span> <span class="n">variables_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">var1</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">var2</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="n">var3</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variables_name</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="n">var1</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="n">var2</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="n">var3</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="n">variables_name</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="Continuation.same_solutions_as">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.same_solutions_as">[docs]</a>
    <span class="k">def</span> <span class="nf">same_solutions_as</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="p">,</span>
        <span class="n">parameters</span><span class="p">,</span>
        <span class="n">solutions_types</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;HB&quot;</span><span class="p">,</span> <span class="s2">&quot;BP&quot;</span><span class="p">,</span> <span class="s2">&quot;UZ&quot;</span><span class="p">,</span> <span class="s2">&quot;PD&quot;</span><span class="p">,</span> <span class="s2">&quot;TR&quot;</span><span class="p">,</span> <span class="s2">&quot;LP&quot;</span><span class="p">),</span>
        <span class="n">tol</span><span class="o">=</span><span class="mf">2.0e-2</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the continuation has exactly the same solutions as another Continuation object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other: Continuation</span>
<span class="sd">            The other continuation object to check the solutions.</span>
<span class="sd">        parameters: list(str)</span>
<span class="sd">            The parameters to be considered to check if the solutions are the same.</span>
<span class="sd">        solutions_types: list(str)</span>
<span class="sd">            The types of solution to consider in the search.</span>
<span class="sd">            Default to `[&#39;HB&#39;, &#39;BP&#39;, &#39;UZ&#39;, &#39;PD&#39;, &#39;TR&#39;, &#39;LP&#39;]`.</span>
<span class="sd">        tol: float or list(float) or ~numpy.ndarray(float)</span>
<span class="sd">            The numerical tolerance of the comparison to determine if two solutions are equal.</span>
<span class="sd">            If a single float is provided, assume the same tolerance for each parameter.</span>
<span class="sd">            If a list or a 1-D array is passed, it must have the dimension of the number of parameters, each value in the</span>
<span class="sd">            array corresponding to a parameter.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool:</span>
<span class="sd">            `True` if both continuations have exactly the same solutions according to the specified parameters.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ssol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">solutions_types</span><span class="p">)</span>
        <span class="n">osol</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">solutions_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">solutions_types</span><span class="p">)</span>

        <span class="n">npar</span> <span class="o">=</span> <span class="n">ssol</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tol</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">tol</span> <span class="o">=</span> <span class="p">[</span><span class="n">tol</span><span class="p">]</span> <span class="o">*</span> <span class="n">npar</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tol</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">tol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tol</span><span class="p">)</span>

        <span class="n">ssol</span> <span class="o">=</span> <span class="n">_sort_arrays</span><span class="p">(</span><span class="n">ssol</span><span class="p">,</span> <span class="n">npar</span><span class="p">,</span> <span class="n">tol</span><span class="p">)</span>
        <span class="n">osol</span> <span class="o">=</span> <span class="n">_sort_arrays</span><span class="p">(</span><span class="n">osol</span><span class="p">,</span> <span class="n">npar</span><span class="p">,</span> <span class="n">tol</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ssol</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">osol</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="n">ssol</span> <span class="o">-</span> <span class="n">osol</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">)</span></div>


<div class="viewcode-block" id="Continuation.solutions_in">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.solutions_in">[docs]</a>
    <span class="k">def</span> <span class="nf">solutions_in</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="p">,</span>
        <span class="n">parameters</span><span class="p">,</span>
        <span class="n">solutions_types</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;HB&quot;</span><span class="p">,</span> <span class="s2">&quot;BP&quot;</span><span class="p">,</span> <span class="s2">&quot;UZ&quot;</span><span class="p">,</span> <span class="s2">&quot;PD&quot;</span><span class="p">,</span> <span class="s2">&quot;TR&quot;</span><span class="p">,</span> <span class="s2">&quot;LP&quot;</span><span class="p">),</span>
        <span class="n">tol</span><span class="o">=</span><span class="mf">2.0e-2</span><span class="p">,</span>
        <span class="n">return_parameters</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">return_solutions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the continuation solutions are all included in the solutions of another Continuation object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other: Continuation</span>
<span class="sd">            The other continuation object to check the solutions.</span>
<span class="sd">        parameters: list(str)</span>
<span class="sd">            The parameters to be considered to check if the solutions are the same.</span>
<span class="sd">        solutions_types: list(str)</span>
<span class="sd">            The types of solution to consider in the search.</span>
<span class="sd">            Default to `[&#39;HB&#39;, &#39;BP&#39;, &#39;UZ&#39;, &#39;PD&#39;, &#39;TR&#39;, &#39;LP&#39;]`.</span>
<span class="sd">        tol: float or list(float) or ~numpy.ndarray(float)</span>
<span class="sd">            The numerical tolerance of the comparison to determine if two solutions are equal.</span>
<span class="sd">            If a single float is provided, assume the same tolerance for each parameter.</span>
<span class="sd">            If a list or a 1-D array is passed, it must have the dimension of the number of parameters, each value in the</span>
<span class="sd">            array corresponding to a parameter.</span>
<span class="sd">        return_parameters: bool</span>
<span class="sd">            If `True`, return an additional array with the values of the parameters for which the solutions of the two</span>
<span class="sd">            Continuation objects match.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        solutions_in: bool</span>
<span class="sd">            `True` if the solutions are all contained in the other continuations according to the specified parameters.</span>
<span class="sd">        solutions_in_values: ~numpy.ndarray:</span>
<span class="sd">            If `return_parameters` is `True`, an array with the values of the parameters for which the solutions of the two</span>
<span class="sd">            continuations match.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># problem in the docstring above: no sphinx highlight of types due to https://github.com/sphinx-doc/sphinx/issues/9394</span>
        <span class="c1"># letting the problem unsolved because a patch might come later</span>

        <span class="n">res</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">sol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_part_of</span><span class="p">(</span>
            <span class="n">other</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">solutions_types</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">params</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_solutions</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">return_parameters</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">return_solutions</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="Continuation.solutions_part_of">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.solutions_part_of">[docs]</a>
    <span class="k">def</span> <span class="nf">solutions_part_of</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="p">,</span>
        <span class="n">parameters</span><span class="p">,</span>
        <span class="n">solutions_types</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;HB&quot;</span><span class="p">,</span> <span class="s2">&quot;BP&quot;</span><span class="p">,</span> <span class="s2">&quot;UZ&quot;</span><span class="p">,</span> <span class="s2">&quot;PD&quot;</span><span class="p">,</span> <span class="s2">&quot;TR&quot;</span><span class="p">,</span> <span class="s2">&quot;LP&quot;</span><span class="p">),</span>
        <span class="n">tol</span><span class="o">=</span><span class="mf">2.0e-2</span><span class="p">,</span>
        <span class="n">return_parameters</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">return_solutions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">forward</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a subset of the continuation solutions are included in the solutions of another Continuation object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other: Continuation</span>
<span class="sd">            The other continuation object to check the solutions.</span>
<span class="sd">        parameters: list(str)</span>
<span class="sd">            The parameters to be considered to check if the solutions are the same.</span>
<span class="sd">        solutions_types: list(str)</span>
<span class="sd">            The types of solution to consider in the search.</span>
<span class="sd">            Default to `[&#39;HB&#39;, &#39;BP&#39;, &#39;UZ&#39;, &#39;PD&#39;, &#39;TR&#39;, &#39;LP&#39;]`.</span>
<span class="sd">        tol: float or list(float) or ~numpy.ndarray(float)</span>
<span class="sd">            The numerical tolerance of the comparison to determine if two solutions are equal.</span>
<span class="sd">            If a single float is provided, assume the same tolerance for each parameter.</span>
<span class="sd">            If a list or a 1-D array is passed, it must have the dimension of the number of parameters, each value in the</span>
<span class="sd">            array corresponding to a parameter.</span>
<span class="sd">        return_parameters: bool</span>
<span class="sd">            If `True`, return an additional array with the values of the parameters for which the solutions of the two</span>
<span class="sd">            Continuation objects match.</span>
<span class="sd">        return_solutions: bool</span>
<span class="sd">            If `True`, return an additional list with the AUTO solution objects.</span>
<span class="sd">        forward: bool or None, optional</span>
<span class="sd">            If `True`, search only in the forward continuation.</span>
<span class="sd">            If `False`, search only in the backward continuation.</span>
<span class="sd">            If `None`, search in both backward and forward direction.</span>
<span class="sd">            Default to `None`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        part_of: bool</span>
<span class="sd">            `True` if the solutions are all contained in the other continuations according to the specified parameters.</span>
<span class="sd">        solutions_part_of_values: ~numpy.ndarray:</span>
<span class="sd">            If `return_parameters` is `True`, an array with the values of the parameters for which the solutions of the two</span>
<span class="sd">            continuations match.</span>
<span class="sd">        solutions_part_of: list(AUTOSolution object):</span>
<span class="sd">            If `return_solutions` is `True`, a list of the solutions which are included in the other Continuation object.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tol</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">tol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tol</span><span class="p">)</span>

        <span class="n">ssol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">solutions_types</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="n">forward</span><span class="p">)</span>
        <span class="n">osol</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">solutions_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">solutions_types</span><span class="p">)</span>

        <span class="n">npar</span> <span class="o">=</span> <span class="n">ssol</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tol</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">tol</span> <span class="o">=</span> <span class="p">[</span><span class="n">tol</span><span class="p">]</span> <span class="o">*</span> <span class="n">npar</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tol</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">tol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tol</span><span class="p">)</span>

        <span class="n">idx_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ssol</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">osol</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">dif</span> <span class="o">=</span> <span class="n">ssol</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">osol</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dif</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">):</span>
                    <span class="n">idx_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="k">break</span>

        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">return_parameters</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ssol</span><span class="p">[:,</span> <span class="n">idx_list</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">return_solutions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">get_filtered_solutions_list</span><span class="p">(</span>
                        <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
                        <span class="n">values</span><span class="o">=</span><span class="n">ssol</span><span class="p">[:,</span> <span class="n">idx_list</span><span class="p">],</span>
                        <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span>
                        <span class="n">forward</span><span class="o">=</span><span class="n">forward</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="Continuation.branch_possibly_cross">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.branch_possibly_cross">[docs]</a>
    <span class="k">def</span> <span class="nf">branch_possibly_cross</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="p">,</span>
        <span class="n">parameters</span><span class="p">,</span>
        <span class="n">solutions_types</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;HB&quot;</span><span class="p">,</span> <span class="s2">&quot;BP&quot;</span><span class="p">,</span> <span class="s2">&quot;UZ&quot;</span><span class="p">,</span> <span class="s2">&quot;PD&quot;</span><span class="p">,</span> <span class="s2">&quot;TR&quot;</span><span class="p">,</span> <span class="s2">&quot;LP&quot;</span><span class="p">),</span>
        <span class="n">tol</span><span class="o">=</span><span class="mf">2.0e-2</span><span class="p">,</span>
        <span class="n">return_parameters</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">return_solutions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">forward</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the continuations of two Continuation objects are possibly crossing at a given bifurcation point.</span>

<span class="sd">        Warnings</span>
<span class="sd">        --------</span>
<span class="sd">        As indicated by the `possibly`, this test is weak and can be wrong.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other: Continuation</span>
<span class="sd">            The other continuation object to check the solutions.</span>
<span class="sd">        parameters: list(str)</span>
<span class="sd">            The parameters to be considered to check if the solutions are the same.</span>
<span class="sd">        solutions_types: list(str)</span>
<span class="sd">            The types of solution to consider in the search.</span>
<span class="sd">            Default to `[&#39;HB&#39;, &#39;BP&#39;, &#39;UZ&#39;, &#39;PD&#39;, &#39;TR&#39;, &#39;LP&#39;]`.</span>
<span class="sd">        tol: float or list(float) or ~numpy.ndarray(float)</span>
<span class="sd">            The numerical tolerance of the comparison to determine if two solutions are equal.</span>
<span class="sd">            If a single float is provided, assume the same tolerance for each parameter.</span>
<span class="sd">            If a list or a 1-D array is passed, it must have the dimension of the number of parameters, each value in the</span>
<span class="sd">            array corresponding to a parameter.</span>
<span class="sd">        return_parameters: bool</span>
<span class="sd">            If `True`, return an additional array with the values of the parameters for which the solutions of the two</span>
<span class="sd">            Continuation objects match.</span>
<span class="sd">        return_solutions: bool</span>
<span class="sd">            If `True`, return an additional list with the AUTO solution objects.</span>
<span class="sd">        forward: bool or None, optional</span>
<span class="sd">            If `True`, search only in the forward continuation.</span>
<span class="sd">            If `False`, search only in the backward continuation.</span>
<span class="sd">            If `None`, search in both backward and forward direction.</span>
<span class="sd">            Default to `None`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        crossing: bool</span>
<span class="sd">            `True` if the solutions are all contained in the other continuations according to the specified parameters.</span>
<span class="sd">        crossing_values: ~numpy.ndarray</span>
<span class="sd">            If `return_parameters` is `True`, an array with the values of the parameters for which the solutions of the two</span>
<span class="sd">            continuations match.</span>
<span class="sd">        solutions_list: list(AUTOSolution object)</span>
<span class="sd">            If `return_solutions` is `True`, a list of the solutions which are included in the other Continuation object.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tol</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">tol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tol</span><span class="p">)</span>

        <span class="n">ssol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">solutions_types</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="n">forward</span><span class="p">)</span>
        <span class="n">osol</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">solutions_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">solutions_types</span><span class="p">)</span>

        <span class="n">npar</span> <span class="o">=</span> <span class="n">ssol</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tol</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">tol</span> <span class="o">=</span> <span class="p">[</span><span class="n">tol</span><span class="p">]</span> <span class="o">*</span> <span class="n">npar</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tol</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">tol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tol</span><span class="p">)</span>

        <span class="n">idx_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ssol</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">osol</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">dif</span> <span class="o">=</span> <span class="n">ssol</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">osol</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dif</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">):</span>
                    <span class="n">idx_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="k">break</span>

        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">return_parameters</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ssol</span><span class="p">[:,</span> <span class="n">idx_list</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">return_solutions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">get_filtered_solutions_list</span><span class="p">(</span>
                        <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
                        <span class="n">values</span><span class="o">=</span><span class="n">ssol</span><span class="p">[:,</span> <span class="n">idx_list</span><span class="p">],</span>
                        <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span>
                        <span class="n">forward</span><span class="o">=</span><span class="n">forward</span><span class="p">,</span>
                    <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="Continuation.summary">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.summary">[docs]</a>
    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the summary of the |AUTO| continuations.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            The summary.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">summary_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">summary_str</span> <span class="o">+=</span> <span class="s2">&quot;Forward</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">summary_str</span> <span class="o">+=</span> <span class="s2">&quot;=======</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">summary_str</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">summary_str</span> <span class="o">+=</span> <span class="s2">&quot;Backward</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">summary_str</span> <span class="o">+=</span> <span class="s2">&quot;========</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">summary_str</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">summary_str</span></div>


<div class="viewcode-block" id="Continuation.print_summary">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.print_summary">[docs]</a>
    <span class="k">def</span> <span class="nf">print_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print the summary of the |AUTO| continuations.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuation</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>


<div class="viewcode-block" id="Continuation.check_for_repetitions">
<a class="viewcode-back" href="../../../files/technical/continuations.html#auto2.continuations.base.Continuation.check_for_repetitions">[docs]</a>
    <span class="k">def</span> <span class="nf">check_for_repetitions</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">parameters</span><span class="p">,</span>
        <span class="n">tol</span><span class="o">=</span><span class="mf">2.0e-2</span><span class="p">,</span>
        <span class="n">return_parameters</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">return_non_repeating_solutions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">return_repeating_solutions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">forward</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check in solutions in the Continuation object are repeating, possibly indicating that the continuation is looping</span>
<span class="sd">        on itself.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parameters: list(str)</span>
<span class="sd">            The parameters to be considered to check if the solutions are the same.</span>
<span class="sd">        tol: float or list(float) or ~numpy.ndarray(float)</span>
<span class="sd">            The numerical tolerance of the comparison to determine if two solutions are equal.</span>
<span class="sd">            If a single float is provided, assume the same tolerance for each parameter.</span>
<span class="sd">            If a list or a 1-D array is passed, it must have the dimension of the number of parameters, each value in the</span>
<span class="sd">            array corresponding to a parameter.</span>
<span class="sd">        return_parameters: bool</span>
<span class="sd">            If `True`, return an additional array with the values of the parameters for which the solutions are repeating.</span>
<span class="sd">        return_repeating_solutions: bool</span>
<span class="sd">            If `True`, return an additional list with the AUTO solution objects which repeat.</span>
<span class="sd">        return_non_repeating_solutions: bool</span>
<span class="sd">            If `True`, return an additional list with the AUTO solution objects which do nott repeat.</span>
<span class="sd">        forward: bool or None, optional</span>
<span class="sd">            If `True`, search only in the forward continuation.</span>
<span class="sd">            If `False`, search only in the backward continuation.</span>
<span class="sd">            If `None`, search in both backward and forward direction.</span>
<span class="sd">            Default to `None`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        repeating: dict(list(bool))</span>
<span class="sd">            A dictionary with a list of boolean for each direction, indicating for each solution if it is repeating or not.</span>
<span class="sd">        repeating_values: dict(~numpy.ndarray)</span>
<span class="sd">            If `return_parameters` is `True`, a dictionary with for each direction an array with the values of the parameters for the solutions</span>
<span class="sd">            are repeating.</span>
<span class="sd">        non_repeating_solutions_list: dict(list(AUTOSolution object))</span>
<span class="sd">            If `return_non_repeating_solutions` is `True`, a dictionary with for each direction a list of the solutions which are</span>
<span class="sd">            included which do not repeat.</span>
<span class="sd">        repeating_solutions_list: dict(list(AUTOSolution object))</span>
<span class="sd">            If `return_repeating_solutions` is `True`, a dictionary with for each direction a list of the solutions which are</span>
<span class="sd">            included which do repeat.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tol</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">tol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tol</span><span class="p">)</span>

        <span class="n">repeating_solution</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">repeating_solution</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">repeating_solution</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">forward</span><span class="p">:</span>
            <span class="n">repeating_solution</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">forward</span><span class="p">:</span>
            <span class="n">repeating_solution</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">forward_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;forward&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;backward&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>

        <span class="n">sol</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">idx_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">ridx_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="s2">&quot;backward&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">repeating_solution</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">idx_dict</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="n">ridx_dict</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="n">ridx_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="n">ssol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_parameters</span><span class="p">(</span>
                    <span class="n">parameters</span><span class="p">,</span> <span class="n">solutions_types</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="n">forward_dict</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">sol</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="n">ssol</span>

                <span class="n">npar</span> <span class="o">=</span> <span class="n">ssol</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tol</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                    <span class="n">tol</span> <span class="o">=</span> <span class="p">[</span><span class="n">tol</span><span class="p">]</span> <span class="o">*</span> <span class="n">npar</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tol</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                    <span class="n">tol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tol</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ssol</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                        <span class="n">dif</span> <span class="o">=</span> <span class="n">ssol</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">ssol</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dif</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">):</span>
                            <span class="n">ridx_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                            <span class="k">break</span>

                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ssol</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ridx_list</span><span class="p">:</span>
                        <span class="n">repeating_solution</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                        <span class="n">idx_dict</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">repeating_solution</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                        <span class="n">ridx_dict</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">forward</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">repeating_solution</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">repeating_solution</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([])</span>
            <span class="k">if</span> <span class="n">repeating_solution</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">repeating_solution</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">forward</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">repeating_solution</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">repeating_solution</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">repeating_solution</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">repeating_solution</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([])</span>

        <span class="k">if</span> <span class="n">return_parameters</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">forward</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="n">sol</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">][:,</span> <span class="n">ridx_dict</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]],</span>
                        <span class="n">sol</span><span class="p">[</span><span class="s2">&quot;foward&quot;</span><span class="p">][:,</span> <span class="n">ridx_dict</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]],</span>
                    <span class="p">),</span>
                    <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">forward</span><span class="p">:</span>
                <span class="n">params</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">][:,</span> <span class="n">idx_dict</span><span class="p">[</span><span class="s2">&quot;forward&quot;</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">params</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">][:,</span> <span class="n">idx_dict</span><span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">]]</span>

            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
            <span class="p">[</span><span class="n">return_non_repeating_solutions</span><span class="p">,</span> <span class="n">return_repeating_solutions</span><span class="p">]</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">t</span><span class="p">:</span>
                <span class="n">tarr</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">,</span> <span class="s2">&quot;forward&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">repeating_solution</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">tarr</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">repeating_solution</span><span class="p">[</span><span class="n">direction</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">tarr</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="o">~</span><span class="n">tarr</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span>

                <span class="n">all_sols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutions_list_by_direction</span>
                <span class="n">sols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">forward</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;backward&quot;</span><span class="p">,</span> <span class="s2">&quot;forward&quot;</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">repeating_solution</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">dir_sols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_sols</span><span class="p">[</span><span class="n">direction</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
                            <span class="n">dir_sols</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">all_sols</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span>
                            <span class="n">sel_sols</span> <span class="o">=</span> <span class="n">dir_sols</span><span class="p">[</span><span class="n">tarr</span><span class="p">[</span><span class="n">direction</span><span class="p">]]</span>
                            <span class="n">sols</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sel_sols</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">forward</span><span class="p">:</span>
                        <span class="n">direction</span> <span class="o">=</span> <span class="s2">&quot;forward&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">direction</span> <span class="o">=</span> <span class="s2">&quot;backward&quot;</span>
                    <span class="k">if</span> <span class="n">repeating_solution</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">dir_sols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_sols</span><span class="p">[</span><span class="n">direction</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
                        <span class="n">dir_sols</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">all_sols</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span>
                        <span class="n">sel_sols</span> <span class="o">=</span> <span class="n">dir_sols</span><span class="p">[</span><span class="n">tarr</span><span class="p">[</span><span class="n">direction</span><span class="p">]]</span>
                        <span class="n">sols</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sel_sols</span><span class="p">)</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sols</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span></div>
</div>



<span class="k">def</span> <span class="nf">_sort_arrays</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="n">npar</span><span class="p">,</span> <span class="n">tol</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">npar</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">srt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">sol</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">srt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;f8&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">npar</span><span class="p">)),</span>
                <span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;f&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npar</span><span class="p">)],</span>
                <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="p">)</span>

    <span class="n">ssol</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[:,</span> <span class="n">srt</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">npar</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">npar</span><span class="p">):</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">nc</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ssol</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="nb">abs</span><span class="p">(</span><span class="n">ssol</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ssol</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="ow">and</span> <span class="n">ssol</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">ssol</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
                <span class="p">):</span>
                    <span class="n">nc</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="n">ssol</span><span class="p">[:,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="n">ssol</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="n">ssol</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>
                    <span class="n">ssol</span><span class="p">[:,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span>
            <span class="k">if</span> <span class="n">nc</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">break</span>

    <span class="k">return</span> <span class="n">ssol</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Jonathan Demaeyer and Oisín Hamilton.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>